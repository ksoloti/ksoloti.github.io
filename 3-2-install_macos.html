<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Install on Mac - Ksoloti</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
  </head>

   <body lang="en-US" link="#8080F0" vlink="#A040A0" dir="ltr">
    <div id="navbar">
      <a href="index.html">About</a>
      <a href="2-background.html">Background</a>
      <a href="3-install.html">Install</a>
      <a href="4-getting_started.html">Getting&nbsp;Started</a>
      <a href="5-gills.html">Gills</a>
      <a href="6-tutorials.html">Tutorials</a>
    </div>
    <main>
      <div>

        <div style="text-align: center;">
          <h1 style="color: #10A010; font-size: 3em;">3.2. Install on MacOS</h1>
        </div>

          <div style="text-align: center;">
            <img src="img/macos_patcher_window.png">
            <br/>
            <i>Main window of the Axoloti Patcher.</i>
          </div>
        <div class="textparagraph">
          <p>
            The install process for <b>Ksoloti</b> is identical to <b>Axoloti</b> with a few extra steps. To reduce size we split the application into two parts, the main <b>Axoloti application</b>, and a <b>runtime</b> which contains other required files. You must download and install both.
          </p>
          <p>
            Note that you may also have to install <b>Java</b>. Try without installing Java first in order to not mess up your system’s current Java configuration (if any). If the Patcher does not start or complains that Java was not found you can get it <a target="_blank" href="https://www.java.com/en/download/">here</a>.
          </p>
          <p>
            <b>If your Ksoloti Core is currently connected via USB, disconnect it now.</b>
          </p>
          <p>
            <ol type="1">

              <br/><li>
                <p>
                Install the <b>runtime</b>. Head to the <a target="_blank" href="https://github.com/axoloti/axoloti/releases/tag/1.0.12-2">Axoloti Releases</a> page on Github and download the latest <b>axo_runtime_mac_(version).dmg</b> (at the time of writing: axo_runtime_mac_1.0.12.dmg).
                </p>
                <p>
                <div style="text-align: center;">
                  <img src="img/macos_axoloti_runtime_download.png">
                </div>
                </p>
                <p>
                  Open the dmg image and drag the <b>axoloti_runtime</b> folder to your <b>Applications</b> folder.
                </p>
                <p>
                <div style="text-align: center;">
                  <img src="img/macos_axoloti_runtime_drag_to_applications.png">
                </div>
                </p>
                  Check that you have the correct folder structure:
                </p>
                <p>
                <ul>
                  <li>
                    <b>/Applications/axoloti_runtime/platform_osx</b>
                  </li>
                </ul>
                </p>
                <p>
                  Later OSX/MacOS versions have a <b>quarantine</b> feature that blocks unknown apps from being run. Let's find out if your Mac will block the runtime when you start running it. In a terminal, enter:
                </p>
                <p>
                  <code>xattr /Applications/axoloti_runtime</code>
                </p>
                <p>
                <div style="text-align: center;">
                  <img src="img/macos_terminal_xattr.png">
                </div>
                </p>
                <p>
                  If the command returns the phrase <code>com.apple.quarantine</code> the Axoloti runtime will be blocked as soon as you try to compile a patch in the Patcher. To solve this, run the following command in the terminal:
                </p>
                <p>
                  <code>xattr -r -d com.apple.quarantine /Applications/axoloti_runtime</code>
                </p>
                <p>
                <div style="text-align: center;">
                  <img src="img/macos_terminal_xattr-r-d.png">
                </div>
                </p>
                <p>
                  This removes the quarantine extended attributes from everything in the <b>axoloti_runtime</b> folder and makes it usable. There are many ways to do this sort of thing and you may get Apple folks telling you other variants. The method described here seems to work without too much effort.
                </p>
                <p>
                  The <b>Axoloti runtime</b> is now installed. You will not have to move or edit it unless there is a big update, or you reinstall your OS, etc.
                </p>
              </li>

              <br/><li>
                <p>
                  Install the <b>Patcher</b>. From the link in step 1, download the newest <b>axoloti-mac-(version).dmg</b> (at the time of writing: axoloti-mac-1.0.12-2.dmg).
                </p>
                <p>
                <div style="text-align: center;">
                  <img src="img/macos_axoloti_patcher_download.png">
                </div>
                </p>
                <p>
                  Open the dmg image and drag the <b>Axoloti</b> app to your <b>Applications</b> folder.
                </p>
                <p>
                <div style="text-align: center;">
                  <img src="img/macos_axoloti_patcher_drag_to_applications.png">
                </div>
                </p>
                <p>
                  To start the app, hold down the <b>Control</b> button, click on the app icon (or simply right-click), and select <b>Open</b> from the options menu. 
                </p>
                <p>
                <div style="text-align: center;">
                  <img src="img/macos_axoloti_patcher_control_click_open.png">
                </div>
                </p>
                <p>
                <div style="text-align: center;">
                  <img src="img/macos_axoloti_patcher_macos_cannot_verify.png">
                </div>
                </p>
                <p>
                  This will defeat the quarantine from kicking in. You only need to do this once on the first run. Your Mac will remember <b>Axoloti</b> as a recognized app after that and you will be able to start it like any other app.
                </p>
                <p>
                  While the patcher is being installed, you may get a message prompting you to install "<b>git</b>" or the "<b>developer tools</b>". Click <b>Install</b>. Git will be required for automatic syncing of the object libraries.
                </p>
                <p>
                <div style="text-align: center;">
                  <img src="img/macos_axoloti_patcher_install_developer_tools.png">
                </div>
                </p>
              </li>

              <br/><li>
                <p>
                The <b>Patcher</b> is now installed. Now we need to link it to the custom <b>Ksoloti</b> firmware. Head to the <a target="_blank" href="https://github.com/ksoloti/ksoloti">Ksoloti</a> repository on Github and download the source code as a zip file.
                </p>
                <p>
                  <div style="text-align: center;">
                    <img src="img/ksoloti_download_zip.png">
                  </div>
                </p>
                <p>
                  Extract the file <b>ksoloti-master.zip</b> (or similar) to a location of your choice. I usually place it in my ~/Documents folder.
                </p>
              </li>

              <br/><li>
                <p>
                Start the <b>Axoloti</b> app you installed in your Applications folder earlier (this is the <b>Patcher</b>). If you haven't done so yet, remember to hold down the <b>Control</b> button, click on the app icon and select <b>Open</b> from the options menu the first time you launch the <b>Patcher</b>.
                </p>
                <p>
                  <div style="text-align: center;">
                    <img src="img/macos_patcher_window.png">
                  </div>
                </p>
              </li>

              <br/><li>
                <p>
                  In the Patcher, open the <b>File</b> menu and click on <b>Preferences...</b> In the resulting window you will see an option called <b>Firmware Dir</b>.
                </p>
                <p>
                  Click on <b>Select</b> and navigate to the path where you extracted the ksoloti-master.zip from step 3. Then find the subfolder <b>/firmware</b> in the <b>ksoloti-master</b> folder (or similar) and click <b>Open</b>.
                </p>
                <p>
                  <div style="text-align: center;">
                    <img src="img/macos_preferences_firmware_dir.png">
                  </div>
                </p>
                <p>
                  When you’re done the <b>Firmware Dir</b> field should read something like <b>[...]/ksoloti-master/firmware</b>. It is important that you point the directory to the <b>[...]/firmware</b> subfolder. Click <b>OK</b>.
                </p>
                <p>
                  <div style="text-align: center;">
                    <img src="img/macos_preferences_firmware_dir_set.png">
                  </div>
                </p>
              </li>

              <br/><li>
                <p>
                  Close the <b>Patcher</b> and restart it for the new firmware path to take effect.
                </p>
              </li>

              <br/><li>
                <p>
                  Let’s do a first test to make sure all the directories are correctly set. Open the <b>Board</b> menu and click <b>Firmware > Compile</b>. There should be a lot of text running across the console and it should end with the message <b>Done compiling firmware</b>. This is good news – everything is set up correctly so far!
                </p>
                <p>
                  <div style="text-align: center;">
                    <img src="img/macos_patcher_done_compiling_firmware.png">
                  </div>
                </p>
              </li>

              <br/><li>
                <p>
                  We now need to tell the <b>Patcher</b> to fetch the custom <b>ksoloti-objects</b> repository for us. It contains the custom objects so that you can use all GPIO and functions of the Ksoloti Core.
                </p>
                <p>
                  Open the <b>File</b> menu and click on <b>Preferences...</b> again. In the resulting window you will see a table containing items like “factory”, “home” and “community”. Click on the “<b>+</b>” button to the right of it.
                </p>
                <p>
                  <div style="text-align: center;">
                    <img src="img/macos_preferences_add_library.png">
                  </div>
                </p>
                <p>
                  The “add library” window will appear. This is where we set up the remote address to the <b>ksoloti-objects</b> repository. Enter the following settings:
                </p>
                <p>
                  <b>Type:</b> git
                </p>
                <p>
                  <b>ID:</b> ksoloti-objects
                </p>
                <p>
                  <b>Directory:</b> (Click <b>Select</b> and select a folder of your choice. Then, add the string “<b>/ksoloti-objects/</b>” to the path in the text field. This will let Git automatically create the folder <b>ksoloti-objects</b> in the folder you have selected. In this example I again chose my Documents folder then added “<b>/ksoloti-objects/</b>” to the end of the path.
                </p>
                  <b>Remote Path:</b> https://github.com/ksoloti/ksoloti-objects.git
                </p>
                <p>
                  <div style="text-align: center;">
                    <img src="img/macos_add_ksoloti_library.png">
                  </div>
                </p>
                <p>
                  Click <b>Init</b> and confirm. This should create the <b>ksoloti-objects</b> folder in your selected folder and fill it with the custom Ksoloti objects so the <b>Patcher</b> can find and use them. Click <b>OK</b>, and <b>OK</b> again to close the preferences.
                </p>
              </li>

              <br/><li>
                  <p>
                    Connect the <b>Ksoloti Core</b> board. Your Mac should automatically detect it as a USB device. If you want to make sure, open a terminal and enter:
                    </p>
                    <p>
                      <code>ioreg -p IOUSB</code>
                    </p>
                    <p>
                      Confirm that there is a device called "Ksoloti Core" in the list.
                    </p>
                  </p>
                  <div style="text-align: center;">
                    <img src="img/macos_terminal_ioreg.png">
                  </div>
                </p>
              </li>

              <br/><li>
                  <p>
                    In the <b>Patcher</b>, click on <b>Connect</b>. You might get a <b>Firmware CRC mismatch</b> warning. This is because the firmware has been updated since your Ksoloti board was shipped. Click <b>Yes</b>.
                  </p>
                <p>
                  <div style="text-align: center;">
                    <img src="img/macos_firmware_crc_mismatch.png">
                  </div>
                </p>
                  <p>
                    The <b>Patcher</b> should update the board automatically. Wait until it is done. When only the green LED lights up steady, you can click on <b>Connect</b> again.
                  </p>
                <p>
                  <div style="text-align: center;">
                    <img src="img/macos_firmware_crc_flashing.png">
                  </div>
                </p>
                </li>
              </li>

            </ol>
            <br/>
            <p>
              <b>Congratulations, you’re done with the tedious setup process and finally ready to open some patches!</b>
            </p>
            <p>
              <b>Because we are currently using the original Axoloti Patcher, setting up all these custom folders is necessary to ensure legacy compatibility. We are working on making the installation simpler in the future.</b>
            </p>
          </p>
        </div>

      </div>
    </main>
  <script src="index.js"></script>
  </body>
</html>
